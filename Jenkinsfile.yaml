pipeline:
  agent:
    any:
  stages:
    - stage: version
      steps:
        - sh 'python3 --version'
#        - 'safety', 'check', '-r', 'requirements.txt'

    - stage: lint
      steps:
        - sh 'python3 apply_pylint.py

    - stage: Dependency Security Check
      steps:
        - sh 'safety check -r requirements.txt'
    - stage: Build
      steps:
        - sh 'python3 -m venv env'
        - sh 'source env/bin/activate'
        - sh 'pip3 install pytest'
        - sh 'pip3 install pytest-cov'
        - sh 'pip3 install coverage'
        - sh 'pip3 install pylint'

    - stage: Test
      steps:
        - sh 'python3 -m pytest -v tests'
        - sh 'python3 -m coverage run --source=. -m pytest'
        - sh 'python3 -m coverage report -m'
    - stage: Deploy
      steps:
        - sh 'echo "Deploying..."'